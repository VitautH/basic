<?php
namespace app\models;

use Yii;
use app\models\base\OurPartner as BaseOurPartner;
use yii\helpers\ArrayHelper;
use app\core\ImageClass;
use yii\web\UploadedFile;

class Ourpartner extends  BaseOurPartner{
    public $imageFile;

    /**
     * @inheritdoc
     */
    public static function tableName()
    {
        return 'modules_our_partners';
    }
    /**
     * @inheritdoc
     */
    public function attributeLabels()
    {
        return [
            'id' => 'ID',
            'title' => 'Название партнера',
            'url'=> 'URL партнера',
            'main_partner' => 'Партнер месяца'

        ];
    }
    /*
    * Проверка на ввод данных + обязательные поля
    */
    public function rules()
    {
        return [[['title', 'img_url'],'required'],
            [['main_partner'],'boolean'],
            [['url'], 'url', 'defaultScheme' => 'http'],
            [['imageFile'], 'file', 'skipOnEmpty' => true, 'extensions' => 'png, jpg'],

        ];
    }
    public function saveImage()
    {
        $imgUpload =  new ImageClass();

      return  $path = $imgUpload->uploadImage(UploadedFile::getInstance($this, 'imageFile'), 'sliders/');



    }
public function load($data, $formName = null)
{
    if(UploadedFile::getInstance($this, 'imageFile')!==null){
        //ToDo: Сделать Проверку на исключения
 $img_url_path =$this->saveImage();
        $this->setAttribute('img_url', $img_url_path);


    }

    return parent::load($data, $formName); // TODO: Change the autogenerated stub
}



public function validate($attributeNames = null, $clearErrors = true)
{
//var_dump($this->main_partner);
//die;

    return parent::validate($attributeNames, $clearErrors); // TODO: Change the autogenerated stub
}


}